
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>veroku.factors.categorical module &#8212; veroku 0.0.14 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="veroku.factors.gaussian module" href="veroku.factors.gaussian.html" />
    <link rel="prev" title="veroku.factors.experimental.nonlinear_gaussian module" href="veroku.factors.experimental.nonlinear_gaussian.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-veroku.factors.categorical">
<span id="veroku-factors-categorical-module"></span><h1>veroku.factors.categorical module<a class="headerlink" href="#module-veroku.factors.categorical" title="Permalink to this headline">¶</a></h1>
<p>A module for instantiating sparse tables with log probabilities.</p>
<dl class="py class">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Categorical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cardinalities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probs_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_probs_tensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables_assignment_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">veroku.factors._factor.Factor</span></code></p>
<p>A class for instantiating sparse tables with log probabilities.</p>
<p>Construct a SparseLogTable. Either log_probs_table or probs_table should be supplied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>var_names</strong> (<em>str list</em>) – The variable names.</p></li>
<li><p><strong>cardinalities</strong> (<em>int list</em>) – The cardinalities of the variables (i.e, for three binrary variables: [2,2,2]). This is
only required if the probs_table param is supplied instead of the log_probs_tensor.</p></li>
<li><p><strong>probs_table</strong> (<em>dict</em>) – A dictionary with assignments (tuples) as keys and probabilities as values.
Missing assignments are assumed to have zero probability. This parameter is not required if log_probs_tensor
is given.</p></li>
<li><p><strong>log_probs_tensor</strong> (<em>numpy.ndarray</em>) – A dense tensor representation of the log distribution (not required if probs_table is given)</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Using the probs_table parameter:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probs_table</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span><span class="mf">0.8</span><span class="p">,</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mf">0.2</span><span class="p">,</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span><span class="mf">0.4</span><span class="p">,</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mf">0.6</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_cardinalities</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">Categorical</span><span class="p">(</span><span class="n">probs_table</span><span class="o">=</span><span class="n">probs_table</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">var_names</span><span class="o">=</span><span class="n">var_names</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">cardinalities</span><span class="o">=</span><span class="n">var_cardinalities</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or, equivalently, using the log_probs_tensor parameter:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_probs_tensor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.8</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)],</span>
<span class="gp">... </span>                            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_cardinalities</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">Categorical</span><span class="p">(</span><span class="n">log_probs_tensor</span><span class="o">=</span><span class="n">log_probs_tensor</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">var_names</span><span class="o">=</span><span class="n">var_names</span><span class="p">,</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.argmax">
<span class="sig-name descname"><span class="pre">argmax</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.argmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.argmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the first assignment (vector value) that maximises the factor potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The argmax assignment.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.argmax_assignment_names">
<span class="sig-name descname"><span class="pre">argmax_assignment_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.argmax_assignment_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.argmax_assignment_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the first assignment values that maximises the factor potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The argmax assignment.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.cancel">
<span class="sig-name descname"><span class="pre">cancel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.cancel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.cancel" title="Permalink to this definition">¶</a></dt>
<dd><p>Almost like divide, but with a special rule that ensures that division of zeros by zeros results in zeros. When
categorical message factors with zero probabilities are used in Belief Update algorithms, multiplication by the
zero probabilities cause zeros in the cluster potentials, when these messages need to be divided out again, this
results in 0/0 operations. Since, in such cases, we know (from the information in the message) that the
probability value should be zero, it makes sense to set the result of 0/0 operations to 0 in these cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>factor</strong> (<a class="reference internal" href="#veroku.factors.categorical.Categorical" title="veroku.factors.categorical.Categorical"><em>Categorical</em></a>) – The factor to divide by.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The factor quotient.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#veroku.factors.categorical.Categorical" title="veroku.factors.categorical.Categorical">Categorical</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a copy of this factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The copy of this factor.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#veroku.factors.categorical.Categorical" title="veroku.factors.categorical.Categorical">Categorical</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.dense_distribution_array">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dense_distribution_array</span></span><a class="headerlink" href="#veroku.factors.categorical.Categorical.dense_distribution_array" title="Permalink to this definition">¶</a></dt>
<dd><p>An array containing all the discrete assignments and the corresponding probabilities.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.distance_from_vacuous">
<span class="sig-name descname"><span class="pre">distance_from_vacuous</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.distance_from_vacuous"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.distance_from_vacuous" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the Kullback-Leibler (KL) divergence between this factor and a uniform copy of it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The KL divergence.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.divide">
<span class="sig-name descname"><span class="pre">divide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.divide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.divide" title="Permalink to this definition">¶</a></dt>
<dd><p>Divide this factor by another factor and return the result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>factor</strong> (<a class="reference internal" href="#veroku.factors.categorical.Categorical" title="veroku.factors.categorical.Categorical"><em>Categorical</em></a>) – The factor to divide by.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The factor quotient.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#veroku.factors.categorical.Categorical" title="veroku.factors.categorical.Categorical">Categorical</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.equals">
<span class="sig-name descname"><span class="pre">equals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.equals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.equals" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if this factor is the same as another factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>factor</strong> (<a class="reference internal" href="#veroku.factors.categorical.Categorical" title="veroku.factors.categorical.Categorical"><em>Categorical</em></a>) – The other factor to compare to.</p></li>
<li><p><strong>rtol</strong> (<em>float</em>) – The relative tolerance to use for factor equality check.</p></li>
<li><p><strong>atol</strong> (<em>float</em>) – The absolute tolerance to use for factor equality check.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result of the comparison.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.get_df">
<span class="sig-name descname"><span class="pre">get_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">named_assignments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.get_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.get_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a dataframe representation of the factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>named_assignments</strong> (<em>bool</em>) – Whether to use assignment names (instead of indices).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The dataframe</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.kl_divergence">
<span class="sig-name descname"><span class="pre">kl_divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.kl_divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.kl_divergence" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the KL-divergence D_KL(P || Q) = D_KL(self || factor) between a normalized version of this factor and
another factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>factor</strong> (<a class="reference internal" href="#veroku.factors.categorical.Categorical" title="veroku.factors.categorical.Categorical"><em>Categorical</em></a>) – The other factor</p></li>
<li><p><strong>normalize_factor</strong> (<em>bool</em>) – Whether or not to normalize the other factor before computing the KL-divergence.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Kullback-Leibler divergence</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.marginalize">
<span class="sig-name descname"><span class="pre">marginalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.marginalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.marginalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Sum out variables from this factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vrs</strong> – (list) a subset of variables in the factor’s scope</p></li>
<li><p><strong>keep</strong> – Whether to keep or sum out vrs</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The resulting factor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#veroku.factors.categorical.Categorical" title="veroku.factors.categorical.Categorical">Categorical</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.multiply">
<span class="sig-name descname"><span class="pre">multiply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.multiply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.multiply" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply this factor with another factor and return the result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>factor</strong> (<a class="reference internal" href="#veroku.factors.categorical.Categorical" title="veroku.factors.categorical.Categorical"><em>Categorical</em></a>) – The factor to multiply with.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The factor product.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#veroku.factors.categorical.Categorical" title="veroku.factors.categorical.Categorical">Categorical</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize the factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The normalized factor.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#veroku.factors.categorical.Categorical" title="veroku.factors.categorical.Categorical">Categorical</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the distribution as a bar plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>figsize</strong> (<em>tuple</em>) – The figure size.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.potential">
<span class="sig-name descname"><span class="pre">potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assignment</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.potential" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value of the factor for a specific assignment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>assignment</strong> – The assignment</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.reduce">
<span class="sig-name descname"><span class="pre">reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Observe variables to have certain values and return reduced table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vrs</strong> – (list) The variables.</p></li>
<li><p><strong>values</strong> – (tuple or list) Their values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The resulting factor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#veroku.factors.categorical.Categorical" title="veroku.factors.categorical.Categorical">Categorical</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.reorder">
<span class="sig-name descname"><span class="pre">reorder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_var_names_order</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.reorder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.reorder" title="Permalink to this definition">¶</a></dt>
<dd><p>Reorder categorical table variables to a new order and reorder the associated probabilities
accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>new_var_names_order</strong> (<em>str list</em>) – The new variable order.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The factor with new order.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">var_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probs_table</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span><span class="mf">0.1</span><span class="p">,</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mf">0.2</span><span class="p">,</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span><span class="mf">0.3</span><span class="p">,</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mf">0.4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_cardinalities</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">Categorical</span><span class="p">(</span><span class="n">probs_table</span><span class="o">=</span><span class="n">probs_table</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">var_names</span><span class="o">=</span><span class="n">var_names</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">cardinalities</span><span class="o">=</span><span class="n">var_cardinalities</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">reorder</span><span class="p">(</span><span class="n">new_var_names_order</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="go">b   a       prob</span>
<span class="go">0   0       0.1000</span>
<span class="go">0   1       0.3000</span>
<span class="go">1   0       0.2000</span>
<span class="go">1   1       0.4000</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.show"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the factor’s string representation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.Categorical.tensor_operation">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tensor_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_a_var_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_b_var_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#Categorical.tensor_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.Categorical.tensor_operation" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a element wise function to two tensors with named indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor_a</strong> (<em>numpy.ndarray</em>) – The first tensor.</p></li>
<li><p><strong>tensor_b</strong> (<em>numpy.ndarray</em>) – The second tensor.</p></li>
<li><p><strong>tensor_a_var_names</strong> (<em>string list</em>) – The first tensor’s variable names corresponding to the indices.</p></li>
<li><p><strong>tensor_b_var_names</strong> (<em>string list</em>) – The second tensor’s variable names corresponding to the indices.</p></li>
<li><p><strong>func</strong> – The function to apply elementwise to the two tensors (func(a,b))</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The resulting tensor and corresponding variable names</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="veroku.factors.categorical.CategoricalTemplate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CategoricalTemplate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var_templates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cardinalities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probs_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_probs_tensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#CategoricalTemplate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.CategoricalTemplate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">veroku.factors._factor_template.FactorTemplate</span></code></p>
<p>A class for specifying categorical factor templates and creating categorical factors from these templates.</p>
<p>Create a Categorical factor template.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cardinalities</strong> (<em>int list</em>) – The cardinalities of the variables (i.e, for three binrary variables: [2,2,2]). This is
only required if the probs_table param is supplied instead of the log_probs_tensor.</p></li>
<li><p><strong>probs_table</strong> (<em>dict</em>) – A dictionary with assignments (tuples) as keys and probabilities as values.
Missing assignments are assumed to have zero probability. This parameter is not required if log_probs_tensor
is given.</p></li>
<li><p><strong>log_probs_tensor</strong> (<em>numpy.ndarray</em>) – A dense tensor representation of the log distribution (not required if probs_table is given)</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">var_templates</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a_</span><span class="si">{i}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;b_</span><span class="si">{i}</span><span class="s1">&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probs_table</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span><span class="mf">0.8</span><span class="p">,</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mf">0.2</span><span class="p">,</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span><span class="mf">0.4</span><span class="p">,</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mf">0.6</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cardinalities</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">categorical_template</span> <span class="o">=</span> <span class="n">CategoricalTemplate</span><span class="p">(</span><span class="n">probs_table</span><span class="o">=</span><span class="n">probs_table</span><span class="p">,</span>
<span class="gp">... </span>                                           <span class="n">var_names</span><span class="o">=</span><span class="n">var_names</span><span class="p">,</span>
<span class="gp">... </span>                                           <span class="n">cardinalities</span><span class="o">=</span><span class="n">cardinalities</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">categorical_template</span><span class="o">.</span><span class="n">make_factor</span><span class="p">(</span><span class="n">format_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;i&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="veroku.factors.categorical.CategoricalTemplate.make_factor">
<span class="sig-name descname"><span class="pre">make_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">format_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/veroku/factors/categorical.html#CategoricalTemplate.make_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.CategoricalTemplate.make_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a factor with var_templates formatted by format_dict to create specific var names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>format_dict</strong> (<em>str dict</em>) – The dictionary to be used to format the var_templates strings.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The instantiated factor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#veroku.factors.categorical.Categorical" title="veroku.factors.categorical.Categorical">Categorical</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="veroku.factors.categorical.InconsistentAssignmentNamesError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">InconsistentAssignmentNamesError</span></span><a class="reference internal" href="_modules/veroku/factors/categorical.html#InconsistentAssignmentNamesError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#veroku.factors.categorical.InconsistentAssignmentNamesError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Inconsistent Assignment Names Error</p>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">veroku</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">veroku</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="veroku.html">veroku package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="veroku.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="veroku.factors.html">veroku.factors package</a><ul class="current">
<li class="toctree-l5"><a class="reference internal" href="veroku.factors.html#subpackages">Subpackages</a></li>
<li class="toctree-l5 current"><a class="reference internal" href="veroku.factors.html#submodules">Submodules</a></li>
<li class="toctree-l5"><a class="reference internal" href="veroku.factors.html#module-veroku.factors">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="veroku.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="veroku.html#module-veroku">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">veroku</a><ul>
  <li><a href="veroku.html">veroku package</a><ul>
  <li><a href="veroku.factors.html">veroku.factors package</a><ul>
      <li>Previous: <a href="veroku.factors.experimental.nonlinear_gaussian.html" title="previous chapter">veroku.factors.experimental.nonlinear_gaussian module</a></li>
      <li>Next: <a href="veroku.factors.gaussian.html" title="next chapter">veroku.factors.gaussian module</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, EJ Louw.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/veroku.factors.categorical.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>